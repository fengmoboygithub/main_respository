(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["testpdf"],{"71a5":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-redpacket_fill"}),e._v(" 测试例子\n                ")])],1)],1),i("div",{staticClass:"container"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:8}},[i("tree",{attrs:{setting:e.setting,nodes:e.nodes},on:{onClick:e.onClick,onRightClick:e.onRightClick,onCheck:e.onCheck,onCreated:e.handleCreated}})],1),i("el-col",{attrs:{span:16}},[e.showFile?i("v-pdf",{attrs:{url:e.fileUrl,pdfStyle:"display: inline-block; width: 100%; height: 100%;border: solid 1px;"}}):e._e(),e.showUpload?i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"","before-upload":e.beforeAvatarUpload,action:"",accept:".pdf","http-request":e.submitUpload,multiple:!0}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传pdf文件，且不超过1024M")])]):e._e()],1)],1)],1)])},s=[],n=i("f419"),a=i.n(n),r=i("2d8b"),c={name:"testPdf",components:{tree:a.a,vPdf:r["a"]},data:function(){return{nodes:[],showFile:!1,showDir:!1,showUpload:!1,resourcePath:"http://localhost:8080/file/",fileUrl:"",uploadFile:{projectid:"",directoryid:""},ztreeObj:null,setting:{check:{enable:!0,nocheckInherit:!0},data:{simpleData:{enable:!0,pIdKey:"pid"}},view:{showIcon:!1,removeHoverDom:this.removeHoverDom}}}},created:function(){this.initTree()},activated:function(){this.initTree()},methods:{initTree:function(){var e=this;this.net.viewTree({projectid:"32d2b0ea47c111ea820a507b9d975e7c"}).then((function(t){console.log(t);var i=t;i.success&&200===i.code&&(e.nodes=i.list),e.$message.success("数据加载成功")})).catch((function(t){e.$message.error("数据加载失败"),console.log(t)}))},addHoverDom:function(e,t){var i=this,o=document.getElementById("".concat(t.tId,"_a"));if(o&&!o.querySelector(".tree_extra_menu")){var s=document.createElement("ul");if(s.id="".concat(e,"_").concat(t.id,"_ul"),s.classList.add("tree_extra_menu","el-menu","el-menu--popup","el-menu--popup-right-start"),t.isParent){var n=document.createElement("li");n.tabindex="-1",n.classList.add("tree_extra_menuitem","el-menu-item"),n.innerText="上传",n.addEventListener("click",(function(o){o.stopPropagation(),i.uploadFileHover(o,e,t)})),n.addEventListener("mouseover",(function(e){e.stopPropagation(),n.classList.remove("tree_extra_menuitem"),n.classList.add("tree_extra_menuitem_hover")})),n.addEventListener("mouseout",(function(e){e.stopPropagation(),n.classList.add("tree_extra_menuitem"),n.classList.remove("tree_extra_menuitem_hover")})),s.appendChild(n),o.appendChild(s)}var a=document.createElement("li");a.tabindex="-1",a.classList.add("tree_extra_menuitem","el-menu-item"),a.innerText="删除",a.addEventListener("click",(function(e){e.stopPropagation(),i.clickRemove(t)})),a.addEventListener("mouseover",(function(e){e.stopPropagation(),a.classList.remove("tree_extra_menuitem"),a.classList.add("tree_extra_menuitem_hover")})),a.addEventListener("mouseout",(function(e){e.stopPropagation(),a.classList.add("tree_extra_menuitem"),a.classList.remove("tree_extra_menuitem_hover")})),s.appendChild(a);var r=document.createElement("li");r.tabindex="-1",r.classList.add("tree_extra_menuitem","el-menu-item"),r.innerText="查看",r.addEventListener("click",(function(o){o.stopPropagation(),i.onClick(o,e,t)})),r.addEventListener("mouseover",(function(e){e.stopPropagation(),r.classList.remove("tree_extra_menuitem"),r.classList.add("tree_extra_menuitem_hover")})),r.addEventListener("mouseout",(function(e){e.stopPropagation(),r.classList.add("tree_extra_menuitem"),r.classList.remove("tree_extra_menuitem_hover")})),s.appendChild(r),o.appendChild(s)}},removeHoverDom:function(e,t){var i=document.getElementById("".concat(t.tId,"_a"));if(i){var o=i.querySelector(".tree_extra_menu");o&&i.removeChild(o)}},clickRemove:function(e){console.log("remove",e),this.ztreeObj&&this.ztreeObj.removeNode(e)},onClick:function(e,t,i){console.log(e.type,i),i?i.isParent?(this.showFile=!1,this.showDir=!0):(this.showFile=!0,this.showDir=!1,this.fileUrl=this.resourcePath+i.hashname):(this.showFile=!1,this.showDir=!1)},uploadFileHover:function(e,t,i){console.log(e.type,i),i?i.isParent&&(this.showFile=!1,this.showDir=!1,this.showUpload=!0,this.uploadFile={projectid:i.projectid,directoryid:i.id}):(this.showFile=!1,this.showDir=!1,this.showUpload=!1)},onCheck:function(e,t,i){console.log(e.type,i)},onRightClick:function(e,t,i){console.log(e.type,i),this.addHoverDom(t,i)},handleCreated:function(e){this.ztreeObj=e,e.expandNode(e.getNodes()[0],!0)},beforeAvatarUpload:function(e){var t=e.size/1024/1024<1024;return t||this.$message.error("上传文件大小不能超过 1024MB!"),t},seeFileNet:function(e){var t=this;this.net.getManuscriptInfo({id:e.id}).then((function(e){200===e.code?(t.$message.success("底稿信息获取成功"),t.fileUrl=t.resourcePath+e.entity.hashname):t.$message.error("底稿信息获取失败")})).catch((function(e){t.$message.error("服务器错误，底稿信息获取失败！")}))},submitUpload:function(e){var t=this,i=e.file,o=new FormData;o.append("file",i),o.append("projectid",this.uploadFile.projectid),o.append("directoryid",this.uploadFile.directoryid),this.net.addManuscriptInfo(o).then((function(e){200===e.code?(t.$message.success("上传成功"),t.showFile=!0,t.showDir=!1,t.showUpload=!1,t.fileUrl=t.resourcePath+e.entity.hashname,t.initTree()):t.$message.error("上传失败")})).catch((function(e){t.$message.error("服务器错误，上传文件失败！")}))}}},l=c,d=(i("cd9f"),i("2877")),u=Object(d["a"])(l,o,s,!1,null,null,null);t["default"]=u.exports},cd9f:function(e,t,i){"use strict";var o=i("eed9"),s=i.n(o);s.a},eed9:function(e,t,i){}}]);