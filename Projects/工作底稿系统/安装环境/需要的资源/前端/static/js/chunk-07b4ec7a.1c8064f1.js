(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07b4ec7a"],{"3dab":function(e,t,n){},"688c":function(e,t,n){"use strict";var i=n("3dab"),o=n.n(i);o.a},"7abc":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"crumbs"},[n("el-breadcrumb",{attrs:{separator:">>"}},[n("el-breadcrumb-item",[n("i",{staticClass:"el-icon-lx-redpacket_fill"}),e._v(" "+e._s(e.projectInfo.projectname)+"\n                ")]),n("el-breadcrumb-item",[e._v(e._s(e.projectInfo.stagename))])],1)],1),n("div",{staticClass:"container"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:8}},[n("tree",{attrs:{setting:e.setting,nodes:e.nodes},on:{onClick:e.onClick,onRightClick:e.onRightClick,onCheck:e.onCheck,onCreated:e.handleCreated}})],1),n("el-col",{attrs:{span:16}},[e.showFile?n("div",[n("div",{staticClass:"content-title"},[e._v(e._s(e.fileInfo.docname))]),n("el-row",{attrs:{gutter:24}},[n("el-col",{attrs:{span:8}},[n("el-tag",{attrs:{type:"success"}},[e._v("上传人:"+e._s(e.fileInfo.docname))])],1),n("el-col",{attrs:{span:8}},[n("el-tag",{attrs:{type:"success"}},[e._v("修改次数:"+e._s(e.fileInfo.updatecount))])],1),n("el-col",{attrs:{span:8}},[n("el-tag",{attrs:{type:"success"}},[e._v("上传时间:"+e._s(e.fileInfo.uploaddate))])],1)],1),n("el-row",[n("v-pdf",{attrs:{url:e.fileInfo.fileUrl,pdfStyle:"display: inline-block; width: 100%; height: 100%;border: solid 1px;"}})],1)],1):e._e(),e.showDir?n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:20}},[n("div",{staticClass:"plugins-tips"},[e._v(e._s(e.dirInfo.dirname))])])],1),n("div",{staticClass:"content-title"},[e._v("历史意见")]),n("el-table",{ref:"hisOpinionTable",staticClass:"table",attrs:{data:e.hisOpinionTableData,border:"","header-cell-class-name":"table-header"}},[n("el-table-column",{attrs:{prop:"id",label:"ID",width:"75",align:"center"}}),n("el-table-column",{attrs:{prop:"name",label:"发表人"}}),n("el-table-column",{attrs:{prop:"time",label:"发表时间"}}),n("el-table-column",{attrs:{prop:"opinion",label:"意见"}})],1),n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1):e._e()])],1)],1)])},o=[],a=(n("7f7f"),n("f419")),s=n.n(a),r=n("2d8b"),l=n("f121"),c={name:"upload",components:{tree:s.a,vPdf:r["a"]},data:function(){return{query:{pageIndex:1,pageSize:10},projectInfo:{id:"",projectname:"",projectno:"",projecttype:"",stage:"",stagename:""},dirInfo:{dirname:""},fileInfo:{docname:"",username:"",uploaddate:"",updatecount:"",fileUrl:""},opinion:"",hisOpinionTableData:[],pageTotal:4,hisOpinionInfo:{projectid:"",directoryid:""},nodes:[],showFile:!1,showDir:!1,resourcePath:l["a"].ME_IP_INFO+l["a"].FILE_BASEURL,fileUrl:"",uploadFile:{projectid:"",directoryid:""},ztreeObj:null,setting:{check:{enable:!0,nocheckInherit:!0},data:{simpleData:{enable:!0,pIdKey:"pid"}},view:{showIcon:!1,removeHoverDom:this.removeHoverDom}}}},created:function(){this.getProjectInfo(),this.initTree()},activated:function(){this.getProjectInfo(),this.initTree()},methods:{getHisOpinionTableData:function(){this.hisOpinionTableData=[{id:"1",name:"曹植想",time:"2019-12-12",opinion:"不通过，A.pdf需要修改，B.pdf需要补充"},{id:"2",name:"曹植想",time:"2019-12-12",opinion:"不通过，缺少财务报告"},{id:"3",name:"曹植想",time:"2019-12-12",opinion:"不通过，A.pdf需要修改，B.pdf需要补充，缺少财务报告"}]},handlePageChange:function(e){this.$set(this.query,"pageIndex",e),this.getHisOpinionTableData()},getProjectInfo:function(){var e=this;this.net.get_ProjectInfo({id:this.$route.query.id}).then((function(t){console.log(t),e.projectInfo=t.entity})).catch((function(t){e.$message.error("项目信息数据加载失败"),console.log(t)}))},initTree:function(){var e=this;this.net.viewTree({projectid:this.$route.query.id,projectStage:this.$route.query.projectStage}).then((function(t){console.log(t);var n=t;n.success&&200===n.code&&(e.nodes=n.list)})).catch((function(t){e.$message.error("目录树数据加载失败"),console.log(t)}))},addHoverDom:function(e,t){var n=this,i=document.getElementById("".concat(t.tId,"_a"));if(i&&!i.querySelector(".tree_extra_menu")){var o=document.createElement("ul");o.id="".concat(e,"_").concat(t.id,"_ul"),o.classList.add("tree_extra_menu","el-menu","el-menu--popup","el-menu--popup-right-start");var a=document.createElement("li");a.tabindex="-1",a.classList.add("tree_extra_menuitem","el-menu-item"),a.innerText="查看",a.addEventListener("click",(function(i){i.stopPropagation(),n.onClick(i,e,t)})),a.addEventListener("mouseover",(function(e){e.stopPropagation(),a.classList.remove("tree_extra_menuitem"),a.classList.add("tree_extra_menuitem_hover")})),a.addEventListener("mouseout",(function(e){e.stopPropagation(),a.classList.add("tree_extra_menuitem"),a.classList.remove("tree_extra_menuitem_hover")})),o.appendChild(a),i.appendChild(o)}},removeHoverDom:function(e,t){var n=document.getElementById("".concat(t.tId,"_a"));if(n){var i=n.querySelector(".tree_extra_menu");i&&n.removeChild(i)}},clickRemove:function(e){console.log("remove",e),this.ztreeObj&&this.ztreeObj.removeNode(e)},onClick:function(e,t,n){console.log(e.type,n),n?n.isParent?(this.dirInfo.dirname=n.name,this.hisOpinionInfo={projectid:n.projectid,directoryid:n.id},this.getHisOpinionTableData(),this.showFile=!1,this.showDir=!0):(this.seeFileNet({id:n.id}),this.showFile=!0,this.showDir=!1):(this.showFile=!1,this.showDir=!1)},onCheck:function(e,t,n){console.log(e.type,n)},onRightClick:function(e,t,n){console.log(e.type,n),this.addHoverDom(t,n)},handleCreated:function(e){this.ztreeObj=e,e.expandNode(e.getNodes()[0],!0)},seeFileNet:function(e){var t=this;this.net.get_ManuscriptInfo({id:e.id}).then((function(e){200===e.code?(t.$message.success("底稿信息获取成功"),t.fileInfo.fileUrl=t.resourcePath+e.entity.hashname,t.fileInfo.docname=e.entity.docname,t.fileInfo.username=e.entity.username,t.fileInfo.uploaddate=e.entity.uploaddate,t.fileInfo.updatecount=e.entity.updatecount):t.$message.error("底稿信息获取失败")})).catch((function(e){t.$message.error("服务器错误，底稿信息获取失败！")}))}}},d=c,u=(n("688c"),n("2877")),p=Object(u["a"])(d,i,o,!1,null,null,null);t["default"]=p.exports}}]);