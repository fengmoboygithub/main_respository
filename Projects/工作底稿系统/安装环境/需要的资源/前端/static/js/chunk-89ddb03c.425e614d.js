(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89ddb03c"],{1830:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"crumbs"},[o("el-breadcrumb",{attrs:{separator:">>"}},[o("el-breadcrumb-item",[o("i",{staticClass:"el-icon-lx-redpacket_fill"}),e._v(" "+e._s(e.projectInfo.projectname)+"\n                ")]),o("el-breadcrumb-item",[e._v(e._s(e.projectInfo.stagename))])],1)],1),o("div",{staticClass:"container"},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("tree",{attrs:{setting:e.setting,nodes:e.nodes},on:{onClick:e.onClick,onRightClick:e.onRightClick,onCheck:e.onCheck,onCreated:e.handleCreated}})],1),o("el-col",{attrs:{span:12}},[e.showFile?o("div",[o("div",{staticClass:"content-title"},[e._v(e._s(e.fileInfo.docname))]),o("el-row",{attrs:{gutter:24}},[o("el-col",{attrs:{span:8}},[o("el-tag",{attrs:{type:"success"}},[e._v("上传人:"+e._s(e.fileInfo.docname))])],1),o("el-col",{attrs:{span:8}},[o("el-tag",{attrs:{type:"success"}},[e._v("修改次数:"+e._s(e.fileInfo.updatecount))])],1),o("el-col",{attrs:{span:8}},[o("el-tag",{attrs:{type:"success"}},[e._v("上传时间:"+e._s(e.fileInfo.uploaddate))])],1)],1),o("el-row",[o("v-pdf",{attrs:{url:e.fileInfo.fileUrl,pdfStyle:"display: inline-block; width: 100%; height: 100%;border: solid 1px;"}})],1)],1):e._e(),e.showDir?o("div",[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("div",{staticClass:"plugins-tips"},[e._v(e._s(e.dirInfo.name))])])],1),o("el-row",[o("el-button",{attrs:{type:"primary"},on:{click:e.onExport}},[e._v("导出")])],1)],1):e._e()])],1)],1)])},i=[],s=o("f419"),r=o.n(s),a=o("2d8b"),c=o("f121"),l=o("4328"),d=o.n(l),u={name:"upload",components:{tree:r.a,vPdf:a["a"]},data:function(){return{query:{directoryId:"",projectId:"",currentPage:1,itemsPerPage:10},projectInfo:{id:"",projectname:"",projectno:"",projecttype:"",stage:"",stagename:""},dirInfo:null,fileInfo:{docname:"",username:"",uploaddate:"",updatecount:"",fileUrl:""},opinion:"",hisOpinionTableData:[],pageTotal:0,nodes:[],showFile:!1,showDir:!1,resourcePath:c["a"].ME_IP_INFO+c["a"].FILE_BASEURL,uploadFile:{projectid:"",directoryid:""},ztreeObj:null,setting:{check:{enable:!1,nocheckInherit:!0,chkboxType:{Y:"s",N:"ps"}},data:{simpleData:{enable:!0,pIdKey:"pid"}},view:{showIcon:!1,removeHoverDom:this.removeHoverDom}}}},created:function(){this.getProjectInfo(),this.initTree()},activated:function(){this.getProjectInfo(),this.initTree()},methods:{getHisOpinionTableData:function(){var e=this;this.query.directoryId=this.dirInfo.id,this.query.projectId=this.dirInfo.projectid,this.net.getListByPage_DirectoryOpinion(this.query).then((function(t){console.log(t),e.hisOpinionTableData=t.data,e.pageTotal=t.recordsTotal||0}))},handlePageChange:function(e){this.$set(this.query,"pageIndex",e),this.getHisOpinionTableData()},getProjectInfo:function(){var e=this;this.net.get_ProjectInfo({id:this.$route.query.id}).then((function(t){console.log(t),e.projectInfo=t.entity})).catch((function(t){e.$message.error("项目信息数据加载失败"),console.log(t)}))},initTree:function(e){var t=this;this.net.viewTree({projectid:this.$route.query.id,projectStage:this.$route.query.projectStage}).then((function(o){console.log(o);var n=o;if(n.success&&200===n.code){t.nodes=n.list;var i=t.nodes;e&&i.length>0&&i.some((function(o){if(console.log(o),o.id==e)return t.ztreeObj.selectNode(o),t.onClick(null,e,o),!0}))}})).catch((function(e){t.$message.error("目录树数据加载失败"),console.log(e)}))},removeHoverDom:function(e,t){var o=document.getElementById("".concat(t.tId,"_a"));if(o){var n=o.querySelector(".tree_extra_menu");n&&o.removeChild(n)}},onClick:function(e,t,o){o?"file"==o.type?(this.seeFileNet({id:o.id}),this.showFile=!0,this.showDir=!1):(this.dirInfo=o,this.showFile=!1,this.showDir=!0):(this.showFile=!1,this.showDir=!1)},onCheck:function(e,t,o){console.log(e.type,o)},onRightClick:function(e,t,o){console.log(e.type,o)},handleCreated:function(e){this.ztreeObj=e,e.expandAll(!0)},seeFileNet:function(e){var t=this;this.net.get_ManuscriptInfo({id:e.id}).then((function(e){200===e.code?(t.$message.success("底稿信息获取成功"),t.fileInfo.fileUrl=t.resourcePath+e.entity.hashname,t.fileInfo.docname=e.entity.docname,t.fileInfo.username=e.entity.username,t.fileInfo.uploaddate=e.entity.uploaddate,t.fileInfo.updatecount=e.entity.updatecount):t.$message.error("底稿信息获取失败")})).catch((function(e){t.$message.error("服务器错误，底稿信息获取失败！")}))},executeDownload:function(e){if(e){var t=document.createElement("a");t.style.display="none",t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}},optMenthod:function(e){var t={projectid:this.$route.query.id,projectStage:this.$route.query.projectStage,directoryid:this.dirInfo.id},o=c["a"].ME_IP_INFO+c["a"].API_BASEURL+c["a"].EXPORT_URL,n=d.a.stringify(t);o+="?"+n,console.log(o),this.executeDownload(o)},onExport:function(){this.optMenthod("导出")}}},h=u,f=(o("636f"),o("2877")),p=Object(f["a"])(h,n,i,!1,null,null,null);t["default"]=p.exports},"31d0":function(e,t,o){},"636f":function(e,t,o){"use strict";var n=o("31d0"),i=o.n(n);i.a}}]);